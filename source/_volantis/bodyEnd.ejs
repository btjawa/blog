<script> 
volantis.rightmenu.jump = (type) => { 
  const selector = type === 'prev' ? 'article .prev-next a.prev' : 'article .prev-next a.next';
  const item = document.querySelector(selector); 
  if(!!item) { 
    if(typeof pjax !== 'undefined') { 
      pjax.loadUrl(item.href) 
    } else { 
      window.location.href = item.href; 
    } 
  } 
} 

volantis.rightmenu.handle(() => { 
  const prev = document.querySelector('#prev').parentElement, 
    next = document.querySelector('#next').parentElement, 
    articlePrev = document.querySelector('article .prev-next a.prev p.title'), 
    articleNext = document.querySelector('article .prev-next a.next p.title'); 

  prev.style.display = articlePrev ? 'block' : 'none'; 
  prev.title = articlePrev ? articlePrev.innerText : null; 
  next.style.display = articleNext ? 'block' : 'none'; 
  next.title = articleNext ? articleNext.innerText : null; 
}, 'prevNext', false)

// 监听 color-schme 变化并修改背景图
function updateBgImage() {
  const colorScheme = document.documentElement.getAttribute('color-scheme')
  document.body.style.backgroundImage = `url("/img/email-pattern-${colorScheme ?? "dark"}.png")`;
}

document.addEventListener('DOMContentLoaded', updateBgImage);

const observer = new MutationObserver((mutationsList, observer) => {
  for (const mutation of mutationsList) {
    if (mutation.type === 'attributes' && mutation.attributeName === 'color-scheme') {
      updateBgImage();
    }
  }
});
observer.observe(document.documentElement, { attributes: true, childList: false, subtree: false });
</script>